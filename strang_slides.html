<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strang Slideshow - Buffered</title>
    <style>
        @import url('https://fonts.cdnfonts.com/css/din-pro');

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            width: 100%; 
            height: 100vh; 
            overflow: hidden;
            background: #000;
            font-family: 'DIN Pro', sans-serif;
        }

        /* --- LOADING SCREEN --- */
        #loader {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: #000;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s ease-out;
        }

        #progress-text {
            color: #fff;
            font-size: 24px;
            letter-spacing: 2px;
            margin-bottom: 20px;
        }

        #progress-bar-bg {
            width: 300px;
            height: 2px;
            background: #333;
        }

        #progress-bar-fill {
            width: 0%;
            height: 100%;
            background: #fff;
            transition: width 0.1s linear;
        }

        /* --- SLIDESHOW --- */
        .slide {
            position: absolute;
            top: 0; left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0;
            transition: none; /* Instant Cut */
            z-index: 1;
            will-change: opacity;
        }

        .slide.active {
            opacity: 1;
            z-index: 2;
        }
    </style>
</head>
<body>

    <div id="loader">
        <div id="progress-text">LOADING 0%</div>
        <div id="progress-bar-bg">
            <div id="progress-bar-fill"></div>
        </div>
    </div>

    <img id="slot-1" class="slide" src="" alt="">
    <img id="slot-2" class="slide" src="" alt="">

    <script>
        // --- CONFIGURATION ---
        const path = 'slides/'; 
        const slideDuration = 3000; // 3 Seconds per slide

        const slides = [
            'Strang Foyer_01.jpg', 'Strang Foyer_02.jpg', 'Strang Foyer_03.jpg', 
            'Strang Foyer_04.jpg', 'Strang Foyer_05.jpg', 'Strang Foyer_06.jpg', 
            'Strang Foyer_07.jpg', 'Strang Foyer_08.jpg', 'Strang Foyer_09.jpg', 
            'Strang Foyer_10.jpg', 'Strang Foyer_11.jpg', 'Strang Foyer_12.jpg', 
            'Strang Foyer_13.jpg', 'Strang Foyer_14.jpg', 'Strang Foyer_15.jpg', 
            'Strang Foyer_16.jpg', 'Strang Foyer_17.jpg', 'Strang Foyer_18.jpg', 
            'Strang Foyer_19.jpg', 'Strang Foyer_20.jpg', 'Strang Foyer_21.jpg', 
            'Strang Foyer_22.jpg', 'Strang Foyer_23.jpg', 'Strang Foyer_24.jpg', 
            'Strang Foyer_25.jpg', 'Strang Foyer_26.jpg', 'Strang Foyer_27.jpg', 
            'Strang Foyer_28.jpg', 'Strang Foyer_29.jpg', 'Strang Foyer_30.jpg', 
            'Strang Foyer_31.jpg', 'Strang Foyer_32.jpg', 'Strang Foyer_33.jpg', 
            'Strang Foyer_34.jpg', 'Strang Foyer_35.jpg', 'Strang Foyer_36.jpg', 
            'Strang Foyer_37.jpg', 'Strang Foyer_38.jpg', 'Strang Foyer_39.jpg', 
            'Strang Foyer_40.jpg', 'Strang Foyer_41.jpg', 'Strang Foyer_42.jpg', 
            'Strang Foyer_43.jpg', 'Strang Foyer_44.jpg', 'Strang Foyer_45.jpg', 
            'Strang Foyer_46.jpg', 'Strang Foyer_47.jpg', 'Strang Foyer_48.jpg', 
            'Strang Foyer_49.jpg', 'Strang Foyer_50.jpg', 'Strang Foyer_51.jpg', 
            'Strang Foyer_52.jpg', 'Strang Foyer_53.jpg', 'Strang Foyer_54.jpg', 
            'Strang Foyer_55.jpg', 'Strang Foyer_56.jpg', 'Strang Foyer_57.jpg', 
            'Strang Foyer_58.jpg', 'Strang Foyer_59.jpg', 'Strang Foyer_60.jpg', 
            'Strang Foyer_61.jpg', 'Strang Foyer_62.jpg', 'Strang Foyer_63.jpg', 
            'Strang Foyer_64.jpg', 'Strang Foyer_65.jpg', 'Strang Foyer_66.jpg', 
            'Strang Foyer_67.jpg', 'Strang Foyer_68.jpg', 'Strang Foyer_69.jpg', 
            'Strang Foyer_70.jpg', 'Strang Foyer_71.jpg', 'Strang Foyer_72.jpg', 
            'Strang Foyer_73.jpg', 'Strang Foyer_74.jpg', 'Strang Foyer_75.jpg', 
            'Strang Foyer_76.jpg', 'Strang Foyer_77.jpg', 'Strang Foyer_78.jpg', 
            'Strang Foyer_79.jpg', 'Strang Foyer_80.jpg', 'Strang Foyer_81.jpg'
        ];

        // --- PRELOAD LOGIC ---
        let loadedCount = 0;
        const totalImages = slides.length;
        // We store the actual Image objects in memory here
        const imageObjects = []; 

        function startPreloading() {
            for (let i = 0; i < totalImages; i++) {
                const img = new Image();
                img.src = path + slides[i];
                
                img.onload = () => { onImageLoaded(); };
                img.onerror = () => { onImageLoaded(); }; // Proceed even if one fails
                
                imageObjects[i] = img; // Keep in memory
            }
        }

        function onImageLoaded() {
            loadedCount++;
            const percent = Math.floor((loadedCount / totalImages) * 100);
            
            // Update UI
            document.getElementById('progress-text').innerText = `LOADING ${percent}%`;
            document.getElementById('progress-bar-fill').style.width = `${percent}%`;

            if (loadedCount >= totalImages) {
                // All done! Fade out loader and start show
                setTimeout(() => {
                    const loader = document.getElementById('loader');
                    loader.style.opacity = '0';
                    setTimeout(() => { loader.style.display = 'none'; }, 500);
                    
                    // START THE ENGINE
                    requestAnimationFrame(updateSlide);
                }, 500);
            }
        }

        // --- PLAYBACK LOGIC ---
        let currentIndex = -1; 
        let activeSlot = 1;
        const img1 = document.getElementById('slot-1');
        const img2 = document.getElementById('slot-2');

        function getSyncedIndex() {
            const now = Date.now();
            const globalTick = Math.floor(now / slideDuration);
            return globalTick % slides.length;
        }

        function updateSlide() {
            const targetIndex = getSyncedIndex();

            if (targetIndex !== currentIndex) {
                // We use the preloaded source from memory
                const nextImageSrc = imageObjects[targetIndex].src;
                
                const currentImg = activeSlot === 1 ? img1 : img2;
                const nextImg = activeSlot === 1 ? img2 : img1;

                nextImg.src = nextImageSrc;
                nextImg.classList.add('active');
                currentImg.classList.remove('active');

                activeSlot = activeSlot === 1 ? 2 : 1;
                currentIndex = targetIndex;
            }

            requestAnimationFrame(updateSlide);
        }

        // Init
        startPreloading();

    </script>
</body>
</html>
