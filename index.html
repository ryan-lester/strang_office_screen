<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timelapse Video Wall</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            width: 100%; 
            height: 100vh; 
            overflow: hidden;
            background: #000;
        }

        #bg-video {
            position: absolute;
            top: 0;
            height: 100%;
            
            /* CRITICAL SETTING:
               We assume 3 screens, so the video width must be 300% of ONE screen.
               If you add a 4th screen, change this to 400vw, etc.
            */
            width: 300vw; 
            
            object-fit: cover;
            /* Transition for smooth adjustments if needed */
            transition: transform 0.5s ease; 
        }
    </style>
</head>
<body>

    <video id="bg-video" muted playsinline></video>

    <script>
        // --- CONFIGURATION ---
        const playlist = [
            "assets/strang_timelapses_1.mp4",
            "assets/strang_timelapses_2.mp4",
            "assets/strang_timelapses_3.mp4",
            "assets/strang_timelapses_4.mp4",
            "assets/strang_timelapses_5.mp4"
        ];

        const videoPlayer = document.getElementById('bg-video');
        let currentTrack = 0;

        // --- SCREEN POSITION LOGIC ---
        function setupScreenOffset() {
            // Get the parameters from the URL (e.g., ?screen=center)
            const urlParams = new URLSearchParams(window.location.search);
            const screenPos = urlParams.get('screen');

            // Shift the video based on which screen this is
            if (screenPos === 'center') {
                // Move video left by 1 screen width
                videoPlayer.style.transform = "translateX(-100vw)";
            } else if (screenPos === 'right') {
                // Move video left by 2 screen widths
                videoPlayer.style.transform = "translateX(-200vw)";
            } else {
                // Default to 'left' (0 shift)
                videoPlayer.style.transform = "translateX(0)";
            }
            
            console.log(`Screen configured as: ${screenPos || 'left (default)'}`);
        }

        // --- PLAYLIST LOGIC ---
        function playTrack(index) {
            if (index >= playlist.length) index = 0;
            currentTrack = index;

            videoPlayer.src = playlist[currentTrack];
            
            // Attempt to play
            const playPromise = videoPlayer.play();
            if (playPromise !== undefined) {
                playPromise.catch(error => {
                    console.error("Autoplay failed:", error);
                    videoPlayer.muted = true; 
                    videoPlayer.play();
                });
            }
        }

        // --- EVENT LISTENERS ---
        videoPlayer.addEventListener('ended', () => {
            playTrack(currentTrack + 1);
        });

        videoPlayer.addEventListener('error', () => {
            console.error(`Error loading ${playlist[currentTrack]}, skipping...`);
            setTimeout(() => { playTrack(currentTrack + 1); }, 1000);
        });

        // --- INITIALIZATION ---
        window.addEventListener('load', () => {
            setupScreenOffset(); // <--- Run the positioning logic
            playTrack(0);        // <--- Start the video
        });

    </script>
</body>
</html>
