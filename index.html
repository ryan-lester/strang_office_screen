<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Strang Office Display Controller</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background-color: #000; }
        iframe { width: 100vw; height: 100vh; border: none; display: block; }
    </style>
</head>
<body>

<iframe id="displayFrame" src=""></iframe>

<script>

    const playlist = [
        'strang_mega.html',       // Index 0: Collaboration (Mega Poster)
        'strang_isometric.html',  // Index 1
        'strang_sketches.html',   // Index 2
        'strang_topography.html'  // Index 3
    ];

    const urlParams = new URLSearchParams(window.location.search);
    const screenID = urlParams.get('screen') || 'center'; 

    // --- NEW: TESTING FEATURE ---
    // Allows you to force the time by adding &minute=0 to the URL
    const debugMinute = urlParams.get('minute');

    function updateDisplay() {
        const now = new Date();
        const hour = now.getHours();
        
        // If &minute= is in the URL, use that. Otherwise use real time.
        const minute = debugMinute ? parseInt(debugMinute) : now.getMinutes();

        let nextPoster = "";

        // --- MODE A: COLLABORATION (First 10 mins OR if forced) ---
        if (minute < 10) {
            nextPoster = `${playlist[0]}?screen=${screenID}`;
        } 
        
        // --- MODE B: RIPPLE LOOP ---
        else {
            let offset = 0;
            if (screenID === 'left') offset = 0;
            if (screenID === 'center') offset = 1;
            if (screenID === 'right') offset = 2;

            const numberOfPosters = playlist.length - 1; 
            const index = ((hour + offset) % numberOfPosters) + 1;
            
            nextPoster = playlist[index];
        }

        const iframe = document.getElementById('displayFrame');
        if (!iframe.src.includes(nextPoster)) {
            console.log(`[${screenID.toUpperCase()}] Switching to: ${nextPoster}`);
            iframe.src = nextPoster;
        }
    }

    function memoryPurgeCheck() {
        const now = new Date();
        if (now.getHours() === 3 && now.getMinutes() === 0) {
            window.location.reload();
        }
    }

    updateDisplay();
    setInterval(updateDisplay, 5000);
    setInterval(memoryPurgeCheck, 60000);

</script>
</body>
</html>
