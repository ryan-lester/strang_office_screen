<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strang OS - Photo Sync</title>
    <style>
        @import url('https://fonts.cdnfonts.com/css/din-pro');

        body, html { 
            margin: 0; padding: 0; 
            width: 100%; height: 100%; 
            overflow: hidden; 
            background-color: #000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #scaler {
            position: relative;
            width: 1080px;
            height: 1920px;
            background: #000;
            overflow: hidden;
            flex-shrink: 0;
            transform-origin: center center;
        }

        #stage {
            position: absolute;
            top: 0; left: 0;
            width: 3240px; 
            height: 1920px;
        }

        /* Replaced iframes with a simple image tag */
        #slide-image {
            position: absolute;
            top: 0; left: 0;
            width: 3240px;
            height: 1920px;
            object-fit: cover; /* Ensures the image fills the 3240x1920 area */
            display: block;
        }

        .ui-layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 999;
            pointer-events: none;
            color: #ffffff; /* Default to white for photos */
            text-shadow: 0 2px 4px rgba(0,0,0,0.5); /* Added shadow for readability on photos */
        }

        .corner-text {
            position: absolute;
            font-family: 'DIN Pro', sans-serif;
            font-weight: 500;
            font-size: 36px; 
            text-transform: uppercase;
            letter-spacing: 4px;
            display: none; 
        }

        .top-left { top: 60px; left: 60px; }
        .bottom-left { bottom: 60px; left: 60px; }
        .top-right { top: 60px; right: 60px; text-align: right; }
        .bottom-right { bottom: 60px; right: 60px; text-align: right; }
    </style>
</head>
<body>

    <div id="scaler">
        <div id="stage">
            <img id="slide-image" src="" alt="Slide">
        </div>

        <div id="ui-container" class="ui-layer">
            <div class="corner-text top-left" id="ui-brand">STRANG.DESIGN</div>
            <div class="corner-text bottom-left" id="ui-city">MIAMI</div>
            <div class="corner-text top-right" id="timer">00:00:00</div>
            <div class="corner-text bottom-right" id="weather">LOADING...</div>
        </div>
    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const screenID = (urlParams.get('screen') || 'center').toLowerCase().trim();
        
        // --- CONFIGURATION ---
        const ROTATION_SPEED = 3000; // 3 Seconds per slide
        const PATH = './slides/';    // Path to your folder
        
        // Define your images here
        const PLAYLIST = [
            '01.jpg',
            '02.jpg',
            '03.jpg',
            '04.jpg' 
            // Add as many as needed
        ];
        // ---------------------

        let currentIndex = -1; 

        function fitToScreen() {
            const scaler = document.getElementById('scaler');
            const targetWidth = 1080;
            const targetHeight = 1920;
            
            const scaleX = window.innerWidth / targetWidth;
            const scaleY = window.innerHeight / targetHeight;
            const scale = Math.min(scaleX, scaleY);

            scaler.style.transform = `scale(${scale})`;
        }

        function checkSync() {
            const now = Date.now();
            // Divide current time by 3000ms to get the current "block" of time
            const timeBlock = Math.floor(now / ROTATION_SPEED);
            // Use modulo to loop through the playlist array
            const targetIndex = timeBlock % PLAYLIST.length;

            if (targetIndex !== currentIndex) {
                updateImage(targetIndex);
            }
        }

        function updateImage(index) {
            const img = document.getElementById('slide-image');
            img.src = PATH + PLAYLIST[index];
            currentIndex = index;
        }

        const stage = document.getElementById('stage');
        
        function updateLayout() {
            if (screenID === 'left')   stage.style.left = '0px';
            if (screenID === 'center') stage.style.left = '-1080px'; 
            if (screenID === 'right')  stage.style.left = '-2160px'; 
            
            fitToScreen();
        }

        function setupUI() {
            const brand = document.getElementById('ui-brand');
            const city = document.getElementById('ui-city');
            const timer = document.getElementById('timer');
            const weather = document.getElementById('weather');

            if (screenID === 'left') { brand.style.display = 'block'; city.style.display = 'block'; }
            if (screenID === 'right') { timer.style.display = 'block'; weather.style.display = 'block'; }
        }

        function updateTime() {
            const now = new Date();
            // Just HH:MM:SS for cleaner look, removed milliseconds
            const estTime = new Intl.DateTimeFormat('en-US', {
                timeZone: 'America/New_York',
                hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit'
            }).format(now);
            
            document.getElementById('timer').innerText = estTime;
            
            checkSync(); 
            requestAnimationFrame(updateTime);
        }

        async function fetchWeather() {
            try {
                const response = await fetch('https://api.open-meteo.com/v1/forecast?latitude=25.7617&longitude=-80.1918&current_weather=true&temperature_unit=fahrenheit');
                const data = await response.json();
                if (data.current_weather) {
                    document.getElementById('weather').innerText = `${Math.round(data.current_weather.temperature)}Â°F`;
                }
            } catch (e) {}
        }

        window.addEventListener('load', () => {
            updateLayout();
            setupUI();
            updateTime();
            fetchWeather();
        });
        window.addEventListener('resize', updateLayout);

    </script>
</body>
</html>
