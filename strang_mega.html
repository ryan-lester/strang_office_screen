<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>STRANG Mega Fur</title>
    <style>
        @import url('https://fonts.cdnfonts.com/css/din-pro');
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300;500&display=swap');

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: #e6e6e6;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* THE RIGID GRID (6480px x 3840px) */
        .mega-wrapper {
            width: 6480px; 
            height: 3840px;
            position: absolute;
            top: 0;
            left: 0;
            background: #fdfdfd; 
            transform-origin: 0 0;
        }

        /* WEBGL CANVAS */
        #furCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
        }

        /* CENTER LOGO */
        .logo-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 20;
            pointer-events: none;
        }

        .mega-logo {
            width: 30%; /* Fits nicely in the Center screen */
            filter: brightness(0) invert(1);
            mix-blend-mode: difference;
        }

    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>

    <div class="mega-wrapper" id="megaWrapper">
        <canvas id="furCanvas"></canvas>
        
        <div class="logo-container">
            <img class="mega-logo" src="assets/strang_logo.png" alt="STRANG">
        </div>
    </div>

<script>
    // --- 1. WEBGL FUR LOGIC (Adapted for 6480px Width) ---
    const DENSITY = 25;   // Slightly lower density for performance on massive canvas
    const LENGTH = 180;   // Longer hair for 4K scale
    const COLOR = '#222222';
    const SPEED = 0.002;

    let time = 0;
    
    // FULL 3-SCREEN DIMENSIONS
    const width = 6480;
    const height = 3840;

    let scene, camera, renderer, linesMesh, positions, fadeMesh;

    function initWebGL() {
        const canvas = document.getElementById('furCanvas');

        scene = new THREE.Scene();
        scene.background = new THREE.Color(0xfdfdfd);

        camera = new THREE.OrthographicCamera(0, width, 0, height, 1, 1000);
        camera.position.z = 10;

        // Force High Performance
        renderer = new THREE.WebGLRenderer({
            canvas: canvas,
            antialias: false, // Turn off AA for performance on 24 million pixels
            preserveDrawingBuffer: true,
            powerPreference: "high-performance"
        });
        renderer.setSize(width, height);
        renderer.autoClear = false;

        // GEOMETRY
        const cols = Math.floor(width / DENSITY);
        const rows = Math.floor(height / DENSITY);
        const totalLines = cols * rows;

        const geometry = new THREE.BufferGeometry();
        positions = new Float32Array(totalLines * 2 * 3);

        let i = 0;
        for (let x = 0; x < width; x += DENSITY) {
            for (let y = 0; y < height; y += DENSITY) {
                // Start
                positions[i] = x; positions[i+1] = y; positions[i+2] = 0;
                // End (Placeholder)
                positions[i+3] = x; positions[i+4] = y; positions[i+5] = 0;
                i += 6;
            }
        }
        geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));

        const material = new THREE.LineBasicMaterial({ color: new THREE.Color(COLOR) });
        linesMesh = new THREE.LineSegments(geometry, material);
        scene.add(linesMesh);

        // FADE LAYER (Creates the trails)
        const fadeGeo = new THREE.PlaneGeometry(width, height);
        fadeGeo.translate(width/2, height/2, 0);
        const fadeMat = new THREE.MeshBasicMaterial({
            color: 0xfdfdfd,
            transparent: true,
            opacity: 0.15 // Lower opacity = Longer trails
        });
        fadeMesh = new THREE.Mesh(fadeGeo, fadeMat);
    }

    function animate() {
        requestAnimationFrame(animate);

        const posArray = linesMesh.geometry.attributes.position.array;
        const total = positions.length / 6;
        let pIndex = 0;

        for (let k = 0; k < total; k++) {
            const x = posArray[pIndex];
            const y = posArray[pIndex + 1];

            // WIND MATH:
            // x * 0.0005 creates a wave that spans the whole 6480px width
            const angle = (Math.cos(x * 0.0005 + time) + Math.sin(y * 0.002 + time)) * Math.PI;

            // Update End Vertex
            posArray[pIndex + 3] = x + Math.cos(angle) * LENGTH;
            posArray[pIndex + 4] = y + Math.sin(angle) * LENGTH;

            pIndex += 6;
        }

        linesMesh.geometry.attributes.position.needsUpdate = true;

        // Render Trail
        renderer.render(fadeMesh, camera);
        renderer.render(scene, camera);

        time += SPEED;
    }

    // --- 2. SCREEN SETUP LOGIC ---
    function setupScreen() {
        const wrapper = document.getElementById('megaWrapper');
        
        // IDENTIFY
        const urlParams = new URLSearchParams(window.location.search);
        const screenID = urlParams.get('screen') || 'center'; 

        // SHIFT
        let shiftX = 0;
        if (screenID === 'left')   shiftX = 0;
        if (screenID === 'center') shiftX = -2160;
        if (screenID === 'right')  shiftX = -4320;

        // SCALE
        const windowW = window.innerWidth;
        const windowH = window.innerHeight;
        const targetW = 2160;
        const targetH = 3840;

        const scaleX = windowW / targetW;
        const scaleY = windowH / targetH;
        const scale = Math.min(scaleX, scaleY);

        // APPLY
        const currentShift = shiftX * scale;
        wrapper.style.transform = `translate(${currentShift}px, 0px) scale(${scale})`;
    }

    // --- INIT ---
    window.addEventListener('load', () => {
        setupScreen();
        initWebGL();
        animate();
    });
    window.addEventListener('resize', setupScreen);

</script>
</body>
</html>
