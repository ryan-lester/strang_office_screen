<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timelapse Sequence</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            width: 100%; 
            height: 100vh; 
            overflow: hidden;
            background: #000;
        }

        #bg-video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover; 
            display: block;
        }
    </style>
</head>
<body>

    <video id="bg-video" muted playsinline></video>

    <script>
        // --- CONFIGURATION ---
        const playlist = [
            "assets/strang_timelapses_1.mp4",
            "assets/strang_timelapses_2.mp4",
            "assets/strang_timelapses_3.mp4",
            "assets/strang_timelapses_4.mp4",
            "assets/strang_timelapses_5.mp4"
        ];

        const videoPlayer = document.getElementById('bg-video');
        let currentTrack = 0;

        // --- FUNCTIONS ---

        function playTrack(index) {
            // Ensure index is valid
            if (index >= playlist.length) index = 0;
            currentTrack = index;

            // Log for debugging
            console.log(`Loading video: ${playlist[currentTrack]}`);

            videoPlayer.src = playlist[currentTrack];
            
            // Promise-based play to catch Autoplay errors
            const playPromise = videoPlayer.play();
            
            if (playPromise !== undefined) {
                playPromise.catch(error => {
                    console.error("Autoplay failed:", error);
                    // Force mute and try again (Browser policy fix)
                    videoPlayer.muted = true; 
                    videoPlayer.play();
                });
            }
        }

        // --- EVENT LISTENERS ---

        // 1. Loop when finished
        videoPlayer.addEventListener('ended', () => {
            console.log("Video ended, next track...");
            playTrack(currentTrack + 1);
        });
        
        // 2. Skip if file is missing/broken
        videoPlayer.addEventListener('error', (e) => {
            console.error(`Error loading ${playlist[currentTrack]}`, e);
            // Wait 1 second before skipping to prevent rapid-fire looping on total failure
            setTimeout(() => {
                playTrack(currentTrack + 1);
            }, 1000);
        });

        // --- INIT ---
        window.addEventListener('load', () => {
            playTrack(0); // Start the first video immediately
        });

    </script>
</body>
</html>
